(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();const d=document.getElementById("file"),r=document.getElementById("c"),l=r.getContext("2d"),g=document.getElementById("info"),e={img:null,rot:0,flipX:!1,flipY:!1,filename:null};function m(){if(!e.img)return;const i=(e.rot%360+360)%360,n=i===90||i===270;r.width=n?e.img.height:e.img.width,r.height=n?e.img.width:e.img.height}function a(){if(!e.img){l.clearRect(0,0,r.width,r.height),g.textContent="未選択";return}m();const i=r.width,n=r.height;l.save(),l.clearRect(0,0,i,n),l.translate(i/2,n/2),l.rotate(e.rot*Math.PI/180),l.scale(e.flipX?-1:1,e.flipY?-1:1),l.drawImage(e.img,-e.img.width/2,-e.img.height/2),l.restore(),g.textContent=`元: ${e.img.width}×${e.img.height} / 出力: ${r.width}×${r.height} / 回転:${e.rot}° / 左右:${e.flipX?"ON":"OFF"} / 上下:${e.flipY?"ON":"OFF"}`}d.addEventListener("change",i=>{var t;const n=(t=i.target.files)==null?void 0:t[0];if(!n)return;const s=URL.createObjectURL(n),c=new Image;e.filename=n.name.replace(/\.[^/.]+$/,""),c.onload=()=>{URL.revokeObjectURL(s),e.img=c,e.rot=0,e.flipX=!1,e.flipY=!1,a()},c.onerror=()=>{URL.revokeObjectURL(s),alert("画像の読み込みに失敗しました。")},c.src=s});document.getElementById("flipX").onclick=()=>{e.img&&(e.flipX=!e.flipX,a())};document.getElementById("flipY").onclick=()=>{e.img&&(e.flipY=!e.flipY,a())};document.getElementById("rotL").onclick=()=>{e.img&&(e.rot=(e.rot-90+360)%360,a())};document.getElementById("rotR").onclick=()=>{e.img&&(e.rot=(e.rot+90)%360,a())};document.getElementById("reset").onclick=()=>{e.img&&(e.rot=0,e.flipX=!1,e.flipY=!1,a())};document.getElementById("download").onclick=()=>{if(!e.img)return;const i=new Date,n=i.getFullYear().toString()+String(i.getMonth()+1).padStart(2,"0")+String(i.getDate()).padStart(2,"0")+"_"+String(i.getHours()).padStart(2,"0")+String(i.getMinutes()).padStart(2,"0")+String(i.getSeconds()).padStart(2,"0"),c=`${e.filename||"image"}_${n}.png`,t=document.createElement("a");t.href=r.toDataURL("image/png"),t.download=c,t.click()};r.width=900;r.height=600;a();
